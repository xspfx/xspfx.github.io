<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Edusphere</title>
  <style>
    :root {
      --background: #0d0d0d;
      --card-bg: rgba(18, 18, 22, 0.6);
      --text: #e0e0e0;
      --muted: #9ca3af;
      --primary-color: #ff00ff;
      --accent-color: #00fff7;
      --max-width: 950px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; }
    body {
      font-family: "Inter", system-ui, sans-serif;
      background: var(--background);
      color: var(--text);
      line-height: 1.7;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      transition: background .3s ease, color .3s ease;
    }

    /* Hintergrund-Canvas */
    #wave-bg {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      filter: blur(18px) brightness(1.2);
    }

    header {
      max-width: var(--max-width);
      margin: 0 auto 1.5rem;
      text-align: center;
      padding-top: 1rem;
    }
    header h1 {
      font-size: 2rem;
      letter-spacing: -0.01em;
      color: var(--accent-color);
      text-shadow: 0 0 12px var(--accent-color);
    }
    header h2 {
      font-size: 1.1rem;
      margin-top: 0.4rem;
      color: var(--muted);
      font-weight: normal;
    }

    /* Burger-Men√º */
    .menu-toggle {
      position: fixed;
      top: 1rem;
      right: 1rem;
      z-index: 1000;
      background: none;
      border: none;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      gap: 4px;
      padding: 6px;
    }
    .menu-toggle span {
      width: 20px;
      height: 2px;
      background: var(--accent-color);
      display: block;
      transition: background 0.3s ease;
    }

    .menu {
      position: fixed;
      top: 1rem;
      right: 3rem;
      background: rgba(20,20,30,0.9);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      padding: 0.75rem;
      display: none;
      flex-direction: column;
      gap: 0.5rem;
      z-index: 999;
    }
    .menu.active { display: flex; }
    .menu button {
      background: var(--accent-color);
      color: black;
      border: none;
      border-radius: 6px;
      padding: 0.4rem 0.8rem;
      font-size: 0.9rem;
      cursor: pointer;
      font-weight: 600;
    }
    .menu button:hover { opacity: 0.85; }

    nav.language-switch {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 0.75rem;
    }
    nav.language-switch button {
      background: var(--accent-color);
      border: none;
      color: black;
      padding: 0.4rem 0.75rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      font-size: 0.9rem;
      transition: all .25s ease;
    }
    nav.language-switch button[aria-pressed="true"] {
      background: var(--primary-color);
      color: black;
    }

    main {
      max-width: var(--max-width);
      margin: 0 auto;
      width: 100%;
      padding: 1rem;
    }

    .card {
      background: var(--card-bg);
      border-radius: 14px;
      padding: 1.5rem 1.5rem 2rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 0 25px rgba(0,0,0,0.6), 0 0 15px rgba(255,255,255,0.05) inset;
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255,255,255,0.08);
      transition: transform .25s ease, box-shadow .25s ease;
    }
    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 0 30px rgba(0,0,0,0.7), 0 0 18px var(--primary-color);
    }

    section { margin: 1.5rem 0; }
    section h2 {
      font-size: 1.2rem;
      margin-bottom: 0.6rem;
      display: inline-block;
      color: var(--primary-color);
      text-shadow: 0 0 10px var(--primary-color);
    }
    .subsection h3 {
      font-size: 1rem;
      margin: 1rem 0 0.5rem;
      color: var(--accent-color);
    }

    p { margin: 0 0 1rem; font-size: 1rem; }
    ul { margin: 0.5rem 0 1rem 1.25rem; }
    li { margin-bottom: 0.5rem; }

    strong.md-strong {
      color: var(--accent-color);
      font-weight: 700;
      text-shadow: 0 0 8px var(--accent-color);
    }
    em.md-em {
      color: var(--primary-color);
      font-style: italic;
      text-shadow: 0 0 6px var(--primary-color);
    }

    footer {
      margin-top: auto;
      text-align: center;
      color: var(--muted);
      font-size: 0.9rem;
      padding: 1rem 0;
    }

    /* Light Mode */
    body.light {
      --background: #ffffff;
      --card-bg: #f5f5f5;
      --text: #111111;
      --muted: #333333;
      --primary-color: #000000;
      --accent-color: #003366;
    }
    body.light * {
      text-shadow: none !important;
      box-shadow: none !important;
      backdrop-filter: none !important;
    }
    body.light .menu { background: #f0f0f0; border-color: #ccc; }
    body.light .menu-toggle span { background: #003366; }

    @media (max-width:600px){
      .card { padding: 1rem; }
      header h1 { font-size: 1.5rem; }
    }
  </style>
</head>
<body>
  <canvas id="wave-bg"></canvas>

  <button class="menu-toggle" id="menu-toggle" aria-label="Men√º √∂ffnen">
    <span></span><span></span><span></span>
  </button>
  <div class="menu" id="menu">
    <button id="mode-toggle"><span id="mode-icon">üåô</span> Dark/Light</button>
  </div>

  <header>
    <h1>Edusphere</h1>
    <h2>Manifest der Edusphere: F√ºr eine neue Aufkl√§rung im digitalen Zeitalter</h2>
    <nav class="language-switch" role="navigation" aria-label="Sprachschalter">
      <button data-lang="de" aria-pressed="true">Deutsch</button>
      <button data-lang="en" aria-pressed="false">English</button>
      <button data-lang="fr" aria-pressed="false">Fran√ßais</button>
      <button data-lang="es" aria-pressed="false">Espa√±ol</button>
      <button data-lang="ru" aria-pressed="false">–†—É—Å—Å–∫–∏–π</button>
      <button data-lang="zh" aria-pressed="false">‰∏≠Êñá</button>
    </nav>
  </header>

  <main id="manifest-content" class="card" role="main" aria-live="polite">
    <p>Lade Manifest...</p>
  </main>

  <footer>
    &copy; 2025 Edusphere ‚Äì F√ºr eine neue Aufkl√§rung
  </footer>

  <script>
    // Markdown Parser Fix
    function escapeHTML(str) {
      return String(str)
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#39;");
    }

    function markdownInlineToHtml(s) {
      if (!s) return s;
      // Bold
      s = s.replace(/\*\*(.+?)\*\*/g, '<strong class="md-strong">$1</strong>');
      // Italic
      s = s.replace(/(^|[^*])\*([^*]+?)\*(?!\*)/g, '$1<em class="md-em">$2</em>');
      return s;
    }

    // Manifest Laden
    async function loadManifest(lang) {
      try {
        const res = await fetch(`./i18n/${lang}.json`, { cache: "no-cache" });
        if (!res.ok) throw new Error("Not found");
        return await res.json();
      } catch (e) {
        return await fetch("./i18n/de.json").then(r => r.json());
      }
    }

    function renderSection(sec) {
      let html = `<section id="${sec.id || ""}" class="card">`;
      html += `<h2>${escapeHTML(sec.title)}</h2>`;

      if (sec.paragraphs) {
        html += sec.paragraphs
          .map(p => `<p>${markdownInlineToHtml(escapeHTML(p))}</p>`)
          .join("");
      }

      if (sec.list) {
        html += "<ul>" + sec.list
          .map(i => `<li>${markdownInlineToHtml(escapeHTML(i))}</li>`)
          .join("") + "</ul>";
      }

      if (sec.subsections) {
        html += sec.subsections.map(sub => {
          let subHtml = `<div class="subsection"><h3>${escapeHTML(sub.title)}</h3>`;
          if (sub.paragraphs) {
            subHtml += sub.paragraphs
              .map(p => `<p>${markdownInlineToHtml(escapeHTML(p))}</p>`)
              .join("");
          }
          if (sub.list) {
            subHtml += "<ul>" + sub.list
              .map(i => `<li>${markdownInlineToHtml(escapeHTML(i))}</li>`)
              .join("") + "</ul>";
          }
          subHtml += "</div>";
          return subHtml;
        }).join("");
      }

      if (sec.closing) {
        if (Array.isArray(sec.closing)) {
          html += sec.closing
            .map(p => `<p>${markdownInlineToHtml(escapeHTML(p))}</p>`)
            .join("");
        } else {
          html += `<p>${markdownInlineToHtml(escapeHTML(sec.closing))}</p>`;
        }
      }

      html += "</section>";
      return html;
    }

    async function renderManifest(lang="de") {
      const data = await loadManifest(lang);
      let html = "";
      html += data.sections.map(renderSection).join("");
      document.getElementById("manifest-content").innerHTML = html;
      document.querySelectorAll(".language-switch button[data-lang]")
        .forEach(b => b.setAttribute("aria-pressed", b.dataset.lang === lang));
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    document.querySelectorAll(".language-switch button[data-lang]").forEach(btn => {
      btn.addEventListener("click", () => {
        if (btn.getAttribute("aria-pressed") === "true") return;
        renderManifest(btn.dataset.lang);
      });
    });

    renderManifest("de");

    // Burger Men√º
    const menuToggle = document.getElementById("menu-toggle");
    const menu = document.getElementById("menu");
    menuToggle.addEventListener("click", () => {
      menu.classList.toggle("active");
    });
    document.addEventListener("click", (e) => {
      if (!menu.contains(e.target) && !menuToggle.contains(e.target)) {
        menu.classList.remove("active");
      }
    });

    // Mode Toggle
    const modeBtn = document.getElementById("mode-toggle");
    const modeIcon = document.getElementById("mode-icon");
    modeBtn.addEventListener("click", () => {
      if (document.body.classList.contains("light")) {
        document.body.classList.remove("light");
        modeIcon.textContent = "üåô";
      } else {
        document.body.classList.add("light");
        modeIcon.textContent = "‚òÄÔ∏è";
      }
    });

    // Hintergrund Wellen
    const canvas = document.getElementById('wave-bg');
    const ctx = canvas.getContext('2d');
    let width, height;

    function resize() {
      width = canvas.width = window.innerWidth;
      height = canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    const waves = [
      { amp: 40, len: 0.008, speed: 0.002, phase: 0 },
      { amp: 25, len: 0.012, speed: 0.0016, phase: 2 },
      { amp: 55, len: 0.006, speed: 0.0023, phase: 4 }
    ];

    function drawWave({ amp, len, speed, phase }, time, color) {
      ctx.beginPath();
      for (let x = 0; x <= width; x += 6) {
        const y = height/2 + amp * Math.sin(x * len + time * speed + phase);
        ctx.lineTo(x, y);
      }
      ctx.strokeStyle = color;
      ctx.lineWidth = 2.2;
      ctx.stroke();
    }

    function animate(time) {
      ctx.clearRect(0, 0, width, height);

      const isLight = document.body.classList.contains("light");
      waves.forEach((wave, i) => {
        const baseColorsDark = [
          "rgba(0,255,255,0.35)",
          "rgba(255,0,255,0.28)",
          "rgba(0,200,255,0.32)"
        ];
        const baseColorsLight = [
          "rgba(0,120,180,0.18)",
          "rgba(150,0,150,0.15)",
          "rgba(0,100,150,0.2)"
        ];
        const color = isLight ? baseColorsLight[i] : baseColorsDark[i];
        drawWave(wave, time, color);
      });

      requestAnimationFrame(animate);
    }
    requestAnimationFrame(animate);
  </script>
</body>
</html>
